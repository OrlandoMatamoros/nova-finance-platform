"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ai/analyze/route";
exports.ids = ["app/api/ai/analyze/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fanalyze%2Froute&page=%2Fapi%2Fai%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fanalyze%2Froute.ts&appDir=%2Fworkspaces%2Fnova-finance-platform%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fworkspaces%2Fnova-finance-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fanalyze%2Froute&page=%2Fapi%2Fai%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fanalyze%2Froute.ts&appDir=%2Fworkspaces%2Fnova-finance-platform%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fworkspaces%2Fnova-finance-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _workspaces_nova_finance_platform_app_api_ai_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/ai/analyze/route.ts */ \"(rsc)/./app/api/ai/analyze/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ai/analyze/route\",\n        pathname: \"/api/ai/analyze\",\n        filename: \"route\",\n        bundlePath: \"app/api/ai/analyze/route\"\n    },\n    resolvedPagePath: \"/workspaces/nova-finance-platform/app/api/ai/analyze/route.ts\",\n    nextConfigOutput,\n    userland: _workspaces_nova_finance_platform_app_api_ai_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/ai/analyze/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhaSUyRmFuYWx5emUlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFpJTJGYW5hbHl6ZSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFpJTJGYW5hbHl6ZSUyRnJvdXRlLnRzJmFwcERpcj0lMkZ3b3Jrc3BhY2VzJTJGbm92YS1maW5hbmNlLXBsYXRmb3JtJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZ3b3Jrc3BhY2VzJTJGbm92YS1maW5hbmNlLXBsYXRmb3JtJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2E7QUFDMUY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ub3ZhLWZpbmFuY2UtcGxhdGZvcm0vPzc1YjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL3dvcmtzcGFjZXMvbm92YS1maW5hbmNlLXBsYXRmb3JtL2FwcC9hcGkvYWkvYW5hbHl6ZS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWkvYW5hbHl6ZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FpL2FuYWx5emVcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2FpL2FuYWx5emUvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvd29ya3NwYWNlcy9ub3ZhLWZpbmFuY2UtcGxhdGZvcm0vYXBwL2FwaS9haS9hbmFseXplL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2FpL2FuYWx5emUvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fanalyze%2Froute&page=%2Fapi%2Fai%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fanalyze%2Froute.ts&appDir=%2Fworkspaces%2Fnova-finance-platform%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fworkspaces%2Fnova-finance-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/ai/analyze/route.ts":
/*!*************************************!*\
  !*** ./app/api/ai/analyze/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_services_gemini__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/gemini */ \"(rsc)/./lib/services/gemini.ts\");\n// app/api/ai/analyze/route.ts\n\n\nasync function OPTIONS(request) {\n    return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](null, {\n        status: 200,\n        headers: {\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Access-Control-Allow-Methods\": \"GET, POST, PUT, DELETE, OPTIONS\",\n            \"Access-Control-Allow-Headers\": \"Content-Type, Authorization\"\n        }\n    });\n}\nasync function POST(request) {\n    console.log(\"API Route /api/ai/analyze called\");\n    try {\n        const body = await request.json();\n        const { prompt, mode = \"basic\", period = \"month\", test } = body;\n        // Si es una llamada de test\n        if (test) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true,\n                message: \"API route is working\"\n            });\n        }\n        if (!prompt) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"El prompt es requerido\"\n            }, {\n                status: 400\n            });\n        }\n        // Verificar API key\n        const apiKey = process.env.GEMINI_API_KEY || \"AIzaSyB_nrbCNAYMesrpGshnDaPSz6pNlW8kksg\";\n        if (!apiKey) {\n            console.error(\"No API key found\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true,\n                response: generateDemoAnalysis(mode, period),\n                summary: generateSummary(mode, period),\n                demo: true\n            });\n        }\n        // Enriquecer el prompt con instrucciones específicas según el modo\n        const enrichedPrompt = enrichPromptByMode(prompt, mode, period);\n        // Usar el servicio de Gemini\n        const gemini = new _lib_services_gemini__WEBPACK_IMPORTED_MODULE_1__.GeminiService(apiKey);\n        const result = await gemini.generateContent(enrichedPrompt);\n        if (!result.success) {\n            console.error(\"Gemini service error:\", result.error);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true,\n                response: generateDemoAnalysis(mode, period),\n                summary: generateSummary(mode, period),\n                demo: true,\n                originalError: result.error\n            });\n        }\n        // Generar resumen del análisis\n        const summary = await generateAISummary(result.response || \"\", mode, period, gemini);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            response: result.response,\n            summary: summary,\n            mode: mode,\n            period: period,\n            demo: false\n        });\n    } catch (error) {\n        console.error(\"API Route Error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            response: generateDemoAnalysis(\"basic\", \"month\"),\n            summary: generateSummary(\"basic\", \"month\"),\n            demo: true,\n            error: error instanceof Error ? error.message : \"Error desconocido\"\n        });\n    }\n}\n// Enriquecer el prompt según el modo de análisis\nfunction enrichPromptByMode(basePrompt, mode, period) {\n    const periodText = {\n        day: \"del d\\xeda de hoy\",\n        week: \"de los \\xfaltimos 7 d\\xedas\",\n        month: \"del \\xfaltimo mes\",\n        quarter: \"del \\xfaltimo trimestre\",\n        year: \"del \\xfaltimo a\\xf1o\"\n    }[period] || \"del per\\xedodo seleccionado\";\n    const modeInstructions = {\n        basic: `\n      MODO: ANÁLISIS BÁSICO OPERATIVO\n      Genera exactamente 5 insights operativos ${periodText}.\n      Formato requerido para cada insight:\n      [TIPO]: success/warning/opportunity/info\n      [TÍTULO]: Título corto y claro (máx 6 palabras)\n      [DESCRIPCIÓN]: Descripción con números específicos (20-30 palabras)\n      [IMPACTO]: high/medium/low\n      [MÉTRICA]: Número o porcentaje clave\n      [ACCIÓN]: true/false\n\n      Enfócate en:\n      1. KPIs operativos inmediatos\n      2. Alertas de costos o eficiencia\n      3. Oportunidades de mejora rápida\n      4. Métricas de rendimiento actual\n      5. Acciones correctivas urgentes\n    `,\n        situational: `\n      MODO: ANÁLISIS SITUACIONAL Y TENDENCIAS\n      Genera exactamente 6 insights situacionales ${periodText}.\n      Formato requerido para cada insight:\n      [TIPO]: trend/warning/opportunity/info\n      [TÍTULO]: Situación o tendencia (máx 6 palabras)\n      [DESCRIPCIÓN]: Contexto, causas y efectos (25-35 palabras)\n      [IMPACTO]: high/medium/low\n      [MÉTRICA]: Variación o tendencia porcentual\n      [TENDENCIA]: up/down/stable\n      [ACCIÓN]: Acción recomendada específica\n\n      Analiza:\n      1. Tendencias de ingresos y costos ${periodText}\n      2. Cambios en comportamiento de clientes\n      3. Variaciones estacionales o cíclicas\n      4. Comparación con períodos anteriores\n      5. Factores externos que afectan el negocio\n      6. Proyección para el próximo período\n    `,\n        strategic: `\n      MODO: ANÁLISIS ESTRATÉGICO PROFUNDO\n      Genera exactamente 7 insights estratégicos para planificación ${periodText}.\n      Formato requerido para cada insight:\n      [TIPO]: strategy/opportunity/trend/recommendation\n      [TÍTULO]: Estrategia o iniciativa (máx 8 palabras)\n      [DESCRIPCIÓN]: Plan detallado con métricas y proyecciones (35-45 palabras)\n      [IMPACTO]: high/medium\n      [MÉTRICA]: ROI esperado o impacto proyectado\n      [TIMEFRAME]: Corto plazo (1-3 meses)/Mediano plazo (3-6 meses)/Largo plazo (6-12 meses)\n      [CONFIANZA]: 70-95 (porcentaje de confianza)\n      [RECURSOS]: Recursos necesarios para implementación\n\n      Desarrolla:\n      1. Estrategia integral para alcanzar objetivos\n      2. Plan de optimización de márgenes\n      3. Roadmap de crecimiento de clientes\n      4. Análisis competitivo y posicionamiento\n      5. Oportunidades de innovación o diversificación\n      6. Plan de implementación con hitos\n      7. Métricas de seguimiento y KPIs\n    `\n    };\n    return `${basePrompt}\\n\\n${modeInstructions[mode] || modeInstructions.basic}`;\n}\n// Generar resumen del análisis con IA\nasync function generateAISummary(analysis, mode, period, gemini) {\n    const summaryPrompt = `\n    Basándote en el siguiente análisis, genera un resumen ejecutivo de 3-4 párrafos:\n    \n    ${analysis}\n    \n    El resumen debe incluir:\n    1. Párrafo 1: Estado general del negocio y principales fortalezas\n    2. Párrafo 2: Principales desafíos y áreas de mejora\n    3. Párrafo 3: Recomendaciones prioritarias y próximos pasos\n    ${mode === \"strategic\" ? \"4. P\\xe1rrafo 4: Proyecci\\xf3n y oportunidades a largo plazo\" : \"\"}\n    \n    Tono: Profesional pero accesible, con datos específicos.\n    Longitud: ${mode === \"strategic\" ? \"150-200\" : \"100-150\"} palabras total.\n  `;\n    const result = await gemini.generateContent(summaryPrompt);\n    if (result.success && result.response) {\n        return result.response;\n    }\n    // Fallback a resumen generado localmente\n    return generateSummary(mode, period);\n}\n// Generar análisis de demo mejorado\nfunction generateDemoAnalysis(mode, period) {\n    const analyses = {\n        basic: `\n[TIPO]: success\n[TÍTULO]: Margen de Ganancia Saludable\n[DESCRIPCIÓN]: Tu margen del 29.4% se mantiene cerca del objetivo del 30%. Los costos están controlados este ${period}.\n[IMPACTO]: high\n[MÉTRICA]: 29.4%\n[ACCIÓN]: false\n\n[TIPO]: warning\n[TÍTULO]: Costos Laborales Elevados\n[DESCRIPCIÓN]: Los costos de personal (28%) exceden el objetivo del 25% para el ${period}. Revisa horarios en horas valle.\n[IMPACTO]: medium\n[MÉTRICA]: 28%\n[ACCIÓN]: true\n\n[TIPO]: opportunity\n[TÍTULO]: Potencial en Ticket Promedio\n[DESCRIPCIÓN]: Aumentar $5 el ticket promedio generaría $10,365 adicionales en el ${period}.\n[IMPACTO]: high\n[MÉTRICA]: +$10.4K\n[ACCIÓN]: true\n\n[TIPO]: info\n[TÍTULO]: Crecimiento de Clientes\n[DESCRIPCIÓN]: Base de clientes creció 15% en el ${period}. Momento ideal para programa de fidelización.\n[IMPACTO]: medium\n[MÉTRICA]: +15%\n[ACCIÓN]: true\n\n[TIPO]: opportunity\n[TÍTULO]: Optimización de Inventario\n[DESCRIPCIÓN]: Reducir inventario lento 20% liberaría $8,000 en capital de trabajo.\n[IMPACTO]: medium\n[MÉTRICA]: $8K\n[ACCIÓN]: true\n    `,\n        situational: `\n[TIPO]: trend\n[TÍTULO]: Tendencia de Ingresos Positiva\n[DESCRIPCIÓN]: Ingresos crecieron 12% vs ${period} anterior. Viernes y sábados generan 45% del total. Mantén promociones exitosas.\n[IMPACTO]: high\n[MÉTRICA]: +12%\n[TENDENCIA]: up\n[ACCIÓN]: Reforzar estrategias de fin de semana\n\n[TIPO]: warning\n[TÍTULO]: Producto en Declive\n[DESCRIPCIÓN]: Pizza Margherita bajó 18% en ventas durante el ${period}. Clientes prefieren opciones más saludables. Considera renovación del menú.\n[IMPACTO]: medium\n[MÉTRICA]: -18%\n[TENDENCIA]: down\n[ACCIÓN]: Renovar receta o crear promoción especial\n\n[TIPO]: trend\n[TÍTULO]: Cambio en Preferencias\n[DESCRIPCIÓN]: Productos premium suben 22% mientras básicos bajan 8%. Clientes buscan experiencias gastronómicas superiores en el ${period}.\n[IMPACTO]: high\n[MÉTRICA]: +22%\n[TENDENCIA]: up\n[ACCIÓN]: Expandir línea premium\n\n[TIPO]: opportunity\n[TÍTULO]: Horario Pico Identificado\n[DESCRIPCIÓN]: 12-2pm y 7-9pm concentran 65% de ventas diarias. Oportunidad de happy hour 3-5pm para el próximo ${period}.\n[IMPACTO]: high\n[MÉTRICA]: 65%\n[TENDENCIA]: stable\n[ACCIÓN]: Implementar happy hour estratégico\n\n[TIPO]: info\n[TÍTULO]: Estacionalidad Detectada\n[DESCRIPCIÓN]: El ${period} muestra patrón estacional típico. Prepararse para aumento 20% en demanda próximas festividades.\n[IMPACTO]: medium\n[MÉTRICA]: +20%\n[TENDENCIA]: up\n[ACCIÓN]: Aumentar inventario y personal temporal\n\n[TIPO]: trend\n[TÍTULO]: Competencia Activa\n[DESCRIPCIÓN]: 3 nuevos competidores en la zona este ${period}. Tu participación de mercado se mantiene en 18% gracias a fidelidad de clientes.\n[IMPACTO]: medium\n[MÉTRICA]: 18%\n[TENDENCIA]: stable\n[ACCIÓN]: Fortalecer programa de lealtad\n    `,\n        strategic: `\n[TIPO]: strategy\n[TÍTULO]: Plan Integral de Crecimiento 30%\n[DESCRIPCIÓN]: Para alcanzar $200K mensuales, implementa: 1) Menú premium (+$15K), 2) Delivery propio (+$12K), 3) Catering corporativo (+$10K). ROI proyectado 180% en 6 meses.\n[IMPACTO]: high\n[MÉTRICA]: +30% ingresos\n[TIMEFRAME]: Mediano plazo (3-6 meses)\n[CONFIANZA]: 85\n[RECURSOS]: $15K inversión inicial, 2 empleados adicionales\n\n[TIPO]: strategy\n[TÍTULO]: Optimización de Margen al 35%\n[DESCRIPCIÓN]: Renegociar con 3 proveedores principales (ahorro 3%), automatizar inventario (ahorro 2%), ajustar porciones sin afectar calidad (ahorro 1.6%). Margen objetivo alcanzable en ${period}.\n[IMPACTO]: high\n[MÉTRICA]: +5.6% margen\n[TIMEFRAME]: Corto plazo (1-3 meses)\n[CONFIANZA]: 78\n[RECURSOS]: Sistema POS avanzado, consultor de costos\n\n[TIPO]: opportunity\n[TÍTULO]: Expansión Digital y Delivery\n[DESCRIPCIÓN]: Mercado delivery crece 25% anual. Implementar app propia + kitchen virtual puede capturar $25K adicionales/mes. Competencia tiene 40% ventas en digital, tú solo 15%.\n[IMPACTO]: high\n[MÉTRICA]: +$25K/mes\n[TIMEFRAME]: Mediano plazo (3-6 meses)\n[CONFIANZA]: 82\n[RECURSOS]: $8K desarrollo app, acuerdo con riders\n\n[TIPO]: strategy\n[TÍTULO]: Programa de Fidelización Inteligente\n[DESCRIPCIÓN]: CRM + programa puntos puede aumentar frecuencia 35% y ticket 20%. Con 2,073 clientes actuales, potencial de $31K adicionales/mes. Benchmarks indican retención del 75% vs 45% actual.\n[IMPACTO]: high\n[MÉTRICA]: +35% frecuencia\n[TIMEFRAME]: Corto plazo (1-3 meses)\n[CONFIANZA]: 88\n[RECURSOS]: CRM ($99/mes), sistema de puntos\n\n[TIPO]: trend\n[TÍTULO]: Posicionamiento Premium vs Competencia\n[DESCRIPCIÓN]: Tu ticket ($76) está 7% bajo competencia premium ($82). Oportunidad de reposicionamiento con renovación de marca y experiencia. Captura adicional 5% mercado = $40K/mes.\n[IMPACTO]: high\n[MÉTRICA]: +5% mercado\n[TIMEFRAME]: Largo plazo (6-12 meses)\n[CONFIANZA]: 72\n[RECURSOS]: Rebranding ($5K), renovación parcial local\n\n[TIPO]: recommendation\n[TÍTULO]: Diversificación con Productos Preparados\n[DESCRIPCIÓN]: Línea de productos preparados (salsas, aderezos) puede generar ingreso pasivo $15K/mes. Inversión inicial $10K, break-even mes 4. Casos éxito similares muestran márgenes 45%.\n[IMPACTO]: medium\n[MÉTRICA]: +$15K/mes\n[TIMEFRAME]: Mediano plazo (3-6 meses)\n[CONFIANZA]: 75\n[RECURSOS]: Cocina industrial certificada, empaque, marketing\n\n[TIPO]: strategy\n[TÍTULO]: Roadmap Trimestral de Implementación\n[DESCRIPCIÓN]: Q1: Optimización costos y fidelización. Q2: Lanzamiento delivery y menú premium. Q3: Expansión productos preparados. Q4: Evaluación y scaling. Proyección: $250K/mes en 12 meses.\n[IMPACTO]: high\n[MÉTRICA]: +58% anual\n[TIMEFRAME]: Largo plazo (6-12 meses)\n[CONFIANZA]: 80\n[RECURSOS]: Team dedicado, $30K inversión total escalonada\n    `\n    };\n    return analyses[mode] || analyses.basic;\n}\n// Generar resumen ejecutivo\nfunction generateSummary(mode, period) {\n    const summaries = {\n        basic: `El negocio muestra un desempeño operativo sólido durante el ${period}, con un margen de ganancia del 29.4% que se acerca al objetivo del 30%. Los ingresos de $158K demuestran estabilidad, aunque existen oportunidades claras de mejora. La base de 2,073 clientes ha crecido un 15%, indicando una tendencia positiva en la captación.\n\nLos principales desafíos identificados son los costos laborales elevados (28% vs objetivo 25%) y el potencial no aprovechado en el ticket promedio. Con ajustes operativos específicos, el negocio puede liberar $8K en capital de trabajo y generar $10K adicionales mensuales.\n\nLas recomendaciones prioritarias incluyen optimizar horarios del personal en horas valle, implementar estrategias de upselling para aumentar el ticket promedio en $5, y capitalizar el crecimiento de clientes con un programa de fidelización estructurado.`,\n        situational: `El análisis situacional del ${period} revela tendencias mixtas pero mayormente positivas. Los ingresos muestran un crecimiento del 12% respecto al período anterior, con una concentración significativa en viernes y sábados (45% del total). Se identifican cambios importantes en las preferencias del consumidor, con productos premium creciendo 22% mientras los básicos declinan 8%.\n\nAlertas importantes incluyen el declive del 18% en Pizza Margherita y la entrada de 3 nuevos competidores en la zona. Sin embargo, la participación de mercado se mantiene estable en 18% gracias a la fidelidad de los clientes existentes. Los patrones de consumo muestran picos claros entre 12-2pm y 7-9pm.\n\nPara capitalizar estas tendencias, se recomienda renovar productos en declive, implementar happy hour estratégico en horarios valle (3-5pm), expandir la línea premium respondiendo a la demanda, y fortalecer el programa de lealtad para mantener la ventaja competitiva. La preparación para la estacionalidad próxima es crítica.`,\n        strategic: `El análisis estratégico proyecta un camino claro hacia el objetivo de $200K mensuales, requiriendo un crecimiento del 30% sobre los $158K actuales. Con la implementación sistemática del plan propuesto, este objetivo es alcanzable en 6 meses con un ROI proyectado del 180%. La estrategia se basa en tres pilares: expansión premium, digitalización/delivery, y diversificación de ingresos.\n\nLos desafíos principales incluyen optimizar el margen del 29.4% actual al 35% objetivo y competir efectivamente con el 40% de ventas digitales de la competencia (vs 15% actual). Sin embargo, las oportunidades son significativas: el mercado delivery crece 25% anual, existe espacio para reposicionamiento premium, y la base de clientes actual permite implementar un programa de fidelización con potencial de $31K adicionales mensuales.\n\nEl roadmap trimestral propone: Q1 enfocado en optimización de costos y fidelización (inversión $5K), Q2 lanzamiento de delivery y menú premium ($10K), Q3 expansión con productos preparados ($10K), y Q4 evaluación y scaling ($5K). La inversión total de $30K se recupera en 4 meses.\n\nLa proyección a 12 meses indica ingresos de $250K mensuales (+58%), con márgenes del 35% y una base de clientes expandida a 3,500. Los factores críticos de éxito incluyen la ejecución disciplinada del plan, mantener la calidad durante la expansión, y la adaptación ágil a la respuesta del mercado.`\n    };\n    return summaries[mode] || summaries.basic;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Ozs7eUNBR3VCLEVBQUVoQyxPQUFPOzs7Ozs7Ozs4REFRWSxFQUFFQSxPQUFPOzs7Ozs7OztrSUFRMkQsRUFBRUEsT0FBTzs7Ozs7Ozs7Z0hBUTNCLEVBQUVBLE9BQU87Ozs7Ozs7O2tCQVF2RyxFQUFFQSxPQUFPOzs7Ozs7OztxREFRMEIsRUFBRUEsT0FBTzs7Ozs7SUFLMUQsQ0FBQztRQUNEaUMsV0FBVyxDQUFDOzs7Ozs7Ozs7Ozs7NExBWTRLLEVBQUVqQyxPQUFPOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFtRGpNLENBQUM7SUFDSDtJQUVBLE9BQU9vQyxRQUFRLENBQUNyQyxLQUFLLElBQUlxQyxTQUFTTCxLQUFLO0FBQ3pDO0FBRUEsNEJBQTRCO0FBQzVCLFNBQVNsQixnQkFBZ0JkLElBQVksRUFBRUMsTUFBYztJQUNuRCxNQUFNcUMsWUFBWTtRQUNoQk4sT0FBTyxDQUFDLDREQUE0RCxFQUFFL0IsT0FBTzs7Ozs2UEFJNEssQ0FBQztRQUUxUGdDLGFBQWEsQ0FBQyw0QkFBNEIsRUFBRWhDLE9BQU87Ozs7cVVBSThRLENBQUM7UUFFbFVpQyxXQUFXLENBQUM7Ozs7Ozt5U0FNeVIsQ0FBQztJQUN4UztJQUVBLE9BQU9JLFNBQVMsQ0FBQ3RDLEtBQUssSUFBSXNDLFVBQVVOLEtBQUs7QUFDM0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ub3ZhLWZpbmFuY2UtcGxhdGZvcm0vLi9hcHAvYXBpL2FpL2FuYWx5emUvcm91dGUudHM/M2YyNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhcHAvYXBpL2FpL2FuYWx5emUvcm91dGUudHNcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IEdlbWluaVNlcnZpY2UgfSBmcm9tICdAL2xpYi9zZXJ2aWNlcy9nZW1pbmknXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPUFRJT05TKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKG51bGwsIHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJzogJyonLFxuICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnOiAnR0VULCBQT1NULCBQVVQsIERFTEVURSwgT1BUSU9OUycsXG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycyc6ICdDb250ZW50LVR5cGUsIEF1dGhvcml6YXRpb24nLFxuICAgIH0sXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnNvbGUubG9nKCdBUEkgUm91dGUgL2FwaS9haS9hbmFseXplIGNhbGxlZCcpXG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IHsgcHJvbXB0LCBtb2RlID0gJ2Jhc2ljJywgcGVyaW9kID0gJ21vbnRoJywgdGVzdCB9ID0gYm9keVxuXG4gICAgLy8gU2kgZXMgdW5hIGxsYW1hZGEgZGUgdGVzdFxuICAgIGlmICh0ZXN0KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgc3VjY2VzczogdHJ1ZSwgXG4gICAgICAgIG1lc3NhZ2U6ICdBUEkgcm91dGUgaXMgd29ya2luZycgXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmICghcHJvbXB0KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdFbCBwcm9tcHQgZXMgcmVxdWVyaWRvJyBcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gVmVyaWZpY2FyIEFQSSBrZXlcbiAgICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWSB8fCBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19HRU1JTklfQVBJX0tFWVxuICAgIFxuICAgIGlmICghYXBpS2V5KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdObyBBUEkga2V5IGZvdW5kJylcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIHJlc3BvbnNlOiBnZW5lcmF0ZURlbW9BbmFseXNpcyhtb2RlLCBwZXJpb2QpLFxuICAgICAgICBzdW1tYXJ5OiBnZW5lcmF0ZVN1bW1hcnkobW9kZSwgcGVyaW9kKSxcbiAgICAgICAgZGVtbzogdHJ1ZVxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBFbnJpcXVlY2VyIGVsIHByb21wdCBjb24gaW5zdHJ1Y2Npb25lcyBlc3BlY8OtZmljYXMgc2Vnw7puIGVsIG1vZG9cbiAgICBjb25zdCBlbnJpY2hlZFByb21wdCA9IGVucmljaFByb21wdEJ5TW9kZShwcm9tcHQsIG1vZGUsIHBlcmlvZClcblxuICAgIC8vIFVzYXIgZWwgc2VydmljaW8gZGUgR2VtaW5pXG4gICAgY29uc3QgZ2VtaW5pID0gbmV3IEdlbWluaVNlcnZpY2UoYXBpS2V5KVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdlbWluaS5nZW5lcmF0ZUNvbnRlbnQoZW5yaWNoZWRQcm9tcHQpXG5cbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdHZW1pbmkgc2VydmljZSBlcnJvcjonLCByZXN1bHQuZXJyb3IpXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICByZXNwb25zZTogZ2VuZXJhdGVEZW1vQW5hbHlzaXMobW9kZSwgcGVyaW9kKSxcbiAgICAgICAgc3VtbWFyeTogZ2VuZXJhdGVTdW1tYXJ5KG1vZGUsIHBlcmlvZCksXG4gICAgICAgIGRlbW86IHRydWUsXG4gICAgICAgIG9yaWdpbmFsRXJyb3I6IHJlc3VsdC5lcnJvclxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBHZW5lcmFyIHJlc3VtZW4gZGVsIGFuw6FsaXNpc1xuICAgIGNvbnN0IHN1bW1hcnkgPSBhd2FpdCBnZW5lcmF0ZUFJU3VtbWFyeShyZXN1bHQucmVzcG9uc2UgfHwgJycsIG1vZGUsIHBlcmlvZCwgZ2VtaW5pKVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICByZXNwb25zZTogcmVzdWx0LnJlc3BvbnNlLFxuICAgICAgc3VtbWFyeTogc3VtbWFyeSxcbiAgICAgIG1vZGU6IG1vZGUsXG4gICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgIGRlbW86IGZhbHNlXG4gICAgfSlcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBSb3V0ZSBFcnJvcjonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHJlc3BvbnNlOiBnZW5lcmF0ZURlbW9BbmFseXNpcygnYmFzaWMnLCAnbW9udGgnKSxcbiAgICAgIHN1bW1hcnk6IGdlbmVyYXRlU3VtbWFyeSgnYmFzaWMnLCAnbW9udGgnKSxcbiAgICAgIGRlbW86IHRydWUsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRXJyb3IgZGVzY29ub2NpZG8nXG4gICAgfSlcbiAgfVxufVxuXG4vLyBFbnJpcXVlY2VyIGVsIHByb21wdCBzZWfDum4gZWwgbW9kbyBkZSBhbsOhbGlzaXNcbmZ1bmN0aW9uIGVucmljaFByb21wdEJ5TW9kZShiYXNlUHJvbXB0OiBzdHJpbmcsIG1vZGU6IHN0cmluZywgcGVyaW9kOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBwZXJpb2RUZXh0ID0ge1xuICAgIGRheTogJ2RlbCBkw61hIGRlIGhveScsXG4gICAgd2VlazogJ2RlIGxvcyDDumx0aW1vcyA3IGTDrWFzJyxcbiAgICBtb250aDogJ2RlbCDDumx0aW1vIG1lcycsXG4gICAgcXVhcnRlcjogJ2RlbCDDumx0aW1vIHRyaW1lc3RyZScsXG4gICAgeWVhcjogJ2RlbCDDumx0aW1vIGHDsW8nXG4gIH1bcGVyaW9kXSB8fCAnZGVsIHBlcsOtb2RvIHNlbGVjY2lvbmFkbydcblxuICBjb25zdCBtb2RlSW5zdHJ1Y3Rpb25zID0ge1xuICAgIGJhc2ljOiBgXG4gICAgICBNT0RPOiBBTsOBTElTSVMgQsOBU0lDTyBPUEVSQVRJVk9cbiAgICAgIEdlbmVyYSBleGFjdGFtZW50ZSA1IGluc2lnaHRzIG9wZXJhdGl2b3MgJHtwZXJpb2RUZXh0fS5cbiAgICAgIEZvcm1hdG8gcmVxdWVyaWRvIHBhcmEgY2FkYSBpbnNpZ2h0OlxuICAgICAgW1RJUE9dOiBzdWNjZXNzL3dhcm5pbmcvb3Bwb3J0dW5pdHkvaW5mb1xuICAgICAgW1TDjVRVTE9dOiBUw610dWxvIGNvcnRvIHkgY2xhcm8gKG3DoXggNiBwYWxhYnJhcylcbiAgICAgIFtERVNDUklQQ0nDk05dOiBEZXNjcmlwY2nDs24gY29uIG7Dum1lcm9zIGVzcGVjw61maWNvcyAoMjAtMzAgcGFsYWJyYXMpXG4gICAgICBbSU1QQUNUT106IGhpZ2gvbWVkaXVtL2xvd1xuICAgICAgW03DiVRSSUNBXTogTsO6bWVybyBvIHBvcmNlbnRhamUgY2xhdmVcbiAgICAgIFtBQ0NJw5NOXTogdHJ1ZS9mYWxzZVxuXG4gICAgICBFbmbDs2NhdGUgZW46XG4gICAgICAxLiBLUElzIG9wZXJhdGl2b3MgaW5tZWRpYXRvc1xuICAgICAgMi4gQWxlcnRhcyBkZSBjb3N0b3MgbyBlZmljaWVuY2lhXG4gICAgICAzLiBPcG9ydHVuaWRhZGVzIGRlIG1lam9yYSByw6FwaWRhXG4gICAgICA0LiBNw6l0cmljYXMgZGUgcmVuZGltaWVudG8gYWN0dWFsXG4gICAgICA1LiBBY2Npb25lcyBjb3JyZWN0aXZhcyB1cmdlbnRlc1xuICAgIGAsXG4gICAgc2l0dWF0aW9uYWw6IGBcbiAgICAgIE1PRE86IEFOw4FMSVNJUyBTSVRVQUNJT05BTCBZIFRFTkRFTkNJQVNcbiAgICAgIEdlbmVyYSBleGFjdGFtZW50ZSA2IGluc2lnaHRzIHNpdHVhY2lvbmFsZXMgJHtwZXJpb2RUZXh0fS5cbiAgICAgIEZvcm1hdG8gcmVxdWVyaWRvIHBhcmEgY2FkYSBpbnNpZ2h0OlxuICAgICAgW1RJUE9dOiB0cmVuZC93YXJuaW5nL29wcG9ydHVuaXR5L2luZm9cbiAgICAgIFtUw41UVUxPXTogU2l0dWFjacOzbiBvIHRlbmRlbmNpYSAobcOheCA2IHBhbGFicmFzKVxuICAgICAgW0RFU0NSSVBDScOTTl06IENvbnRleHRvLCBjYXVzYXMgeSBlZmVjdG9zICgyNS0zNSBwYWxhYnJhcylcbiAgICAgIFtJTVBBQ1RPXTogaGlnaC9tZWRpdW0vbG93XG4gICAgICBbTcOJVFJJQ0FdOiBWYXJpYWNpw7NuIG8gdGVuZGVuY2lhIHBvcmNlbnR1YWxcbiAgICAgIFtURU5ERU5DSUFdOiB1cC9kb3duL3N0YWJsZVxuICAgICAgW0FDQ0nDk05dOiBBY2Npw7NuIHJlY29tZW5kYWRhIGVzcGVjw61maWNhXG5cbiAgICAgIEFuYWxpemE6XG4gICAgICAxLiBUZW5kZW5jaWFzIGRlIGluZ3Jlc29zIHkgY29zdG9zICR7cGVyaW9kVGV4dH1cbiAgICAgIDIuIENhbWJpb3MgZW4gY29tcG9ydGFtaWVudG8gZGUgY2xpZW50ZXNcbiAgICAgIDMuIFZhcmlhY2lvbmVzIGVzdGFjaW9uYWxlcyBvIGPDrWNsaWNhc1xuICAgICAgNC4gQ29tcGFyYWNpw7NuIGNvbiBwZXLDrW9kb3MgYW50ZXJpb3Jlc1xuICAgICAgNS4gRmFjdG9yZXMgZXh0ZXJub3MgcXVlIGFmZWN0YW4gZWwgbmVnb2Npb1xuICAgICAgNi4gUHJveWVjY2nDs24gcGFyYSBlbCBwcsOzeGltbyBwZXLDrW9kb1xuICAgIGAsXG4gICAgc3RyYXRlZ2ljOiBgXG4gICAgICBNT0RPOiBBTsOBTElTSVMgRVNUUkFUw4lHSUNPIFBST0ZVTkRPXG4gICAgICBHZW5lcmEgZXhhY3RhbWVudGUgNyBpbnNpZ2h0cyBlc3RyYXTDqWdpY29zIHBhcmEgcGxhbmlmaWNhY2nDs24gJHtwZXJpb2RUZXh0fS5cbiAgICAgIEZvcm1hdG8gcmVxdWVyaWRvIHBhcmEgY2FkYSBpbnNpZ2h0OlxuICAgICAgW1RJUE9dOiBzdHJhdGVneS9vcHBvcnR1bml0eS90cmVuZC9yZWNvbW1lbmRhdGlvblxuICAgICAgW1TDjVRVTE9dOiBFc3RyYXRlZ2lhIG8gaW5pY2lhdGl2YSAobcOheCA4IHBhbGFicmFzKVxuICAgICAgW0RFU0NSSVBDScOTTl06IFBsYW4gZGV0YWxsYWRvIGNvbiBtw6l0cmljYXMgeSBwcm95ZWNjaW9uZXMgKDM1LTQ1IHBhbGFicmFzKVxuICAgICAgW0lNUEFDVE9dOiBoaWdoL21lZGl1bVxuICAgICAgW03DiVRSSUNBXTogUk9JIGVzcGVyYWRvIG8gaW1wYWN0byBwcm95ZWN0YWRvXG4gICAgICBbVElNRUZSQU1FXTogQ29ydG8gcGxhem8gKDEtMyBtZXNlcykvTWVkaWFubyBwbGF6byAoMy02IG1lc2VzKS9MYXJnbyBwbGF6byAoNi0xMiBtZXNlcylcbiAgICAgIFtDT05GSUFOWkFdOiA3MC05NSAocG9yY2VudGFqZSBkZSBjb25maWFuemEpXG4gICAgICBbUkVDVVJTT1NdOiBSZWN1cnNvcyBuZWNlc2FyaW9zIHBhcmEgaW1wbGVtZW50YWNpw7NuXG5cbiAgICAgIERlc2Fycm9sbGE6XG4gICAgICAxLiBFc3RyYXRlZ2lhIGludGVncmFsIHBhcmEgYWxjYW56YXIgb2JqZXRpdm9zXG4gICAgICAyLiBQbGFuIGRlIG9wdGltaXphY2nDs24gZGUgbcOhcmdlbmVzXG4gICAgICAzLiBSb2FkbWFwIGRlIGNyZWNpbWllbnRvIGRlIGNsaWVudGVzXG4gICAgICA0LiBBbsOhbGlzaXMgY29tcGV0aXRpdm8geSBwb3NpY2lvbmFtaWVudG9cbiAgICAgIDUuIE9wb3J0dW5pZGFkZXMgZGUgaW5ub3ZhY2nDs24gbyBkaXZlcnNpZmljYWNpw7NuXG4gICAgICA2LiBQbGFuIGRlIGltcGxlbWVudGFjacOzbiBjb24gaGl0b3NcbiAgICAgIDcuIE3DqXRyaWNhcyBkZSBzZWd1aW1pZW50byB5IEtQSXNcbiAgICBgXG4gIH1cblxuICByZXR1cm4gYCR7YmFzZVByb21wdH1cXG5cXG4ke21vZGVJbnN0cnVjdGlvbnNbbW9kZV0gfHwgbW9kZUluc3RydWN0aW9ucy5iYXNpY31gXG59XG5cbi8vIEdlbmVyYXIgcmVzdW1lbiBkZWwgYW7DoWxpc2lzIGNvbiBJQVxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVBSVN1bW1hcnkoXG4gIGFuYWx5c2lzOiBzdHJpbmcsIFxuICBtb2RlOiBzdHJpbmcsIFxuICBwZXJpb2Q6IHN0cmluZyxcbiAgZ2VtaW5pOiBHZW1pbmlTZXJ2aWNlXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBzdW1tYXJ5UHJvbXB0ID0gYFxuICAgIEJhc8OhbmRvdGUgZW4gZWwgc2lndWllbnRlIGFuw6FsaXNpcywgZ2VuZXJhIHVuIHJlc3VtZW4gZWplY3V0aXZvIGRlIDMtNCBww6FycmFmb3M6XG4gICAgXG4gICAgJHthbmFseXNpc31cbiAgICBcbiAgICBFbCByZXN1bWVuIGRlYmUgaW5jbHVpcjpcbiAgICAxLiBQw6FycmFmbyAxOiBFc3RhZG8gZ2VuZXJhbCBkZWwgbmVnb2NpbyB5IHByaW5jaXBhbGVzIGZvcnRhbGV6YXNcbiAgICAyLiBQw6FycmFmbyAyOiBQcmluY2lwYWxlcyBkZXNhZsOtb3MgeSDDoXJlYXMgZGUgbWVqb3JhXG4gICAgMy4gUMOhcnJhZm8gMzogUmVjb21lbmRhY2lvbmVzIHByaW9yaXRhcmlhcyB5IHByw7N4aW1vcyBwYXNvc1xuICAgICR7bW9kZSA9PT0gJ3N0cmF0ZWdpYycgPyAnNC4gUMOhcnJhZm8gNDogUHJveWVjY2nDs24geSBvcG9ydHVuaWRhZGVzIGEgbGFyZ28gcGxhem8nIDogJyd9XG4gICAgXG4gICAgVG9ubzogUHJvZmVzaW9uYWwgcGVybyBhY2Nlc2libGUsIGNvbiBkYXRvcyBlc3BlY8OtZmljb3MuXG4gICAgTG9uZ2l0dWQ6ICR7bW9kZSA9PT0gJ3N0cmF0ZWdpYycgPyAnMTUwLTIwMCcgOiAnMTAwLTE1MCd9IHBhbGFicmFzIHRvdGFsLlxuICBgXG5cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2VtaW5pLmdlbmVyYXRlQ29udGVudChzdW1tYXJ5UHJvbXB0KVxuICBcbiAgaWYgKHJlc3VsdC5zdWNjZXNzICYmIHJlc3VsdC5yZXNwb25zZSkge1xuICAgIHJldHVybiByZXN1bHQucmVzcG9uc2VcbiAgfVxuICBcbiAgLy8gRmFsbGJhY2sgYSByZXN1bWVuIGdlbmVyYWRvIGxvY2FsbWVudGVcbiAgcmV0dXJuIGdlbmVyYXRlU3VtbWFyeShtb2RlLCBwZXJpb2QpXG59XG5cbi8vIEdlbmVyYXIgYW7DoWxpc2lzIGRlIGRlbW8gbWVqb3JhZG9cbmZ1bmN0aW9uIGdlbmVyYXRlRGVtb0FuYWx5c2lzKG1vZGU6IHN0cmluZywgcGVyaW9kOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBhbmFseXNlcyA9IHtcbiAgICBiYXNpYzogYFxuW1RJUE9dOiBzdWNjZXNzXG5bVMONVFVMT106IE1hcmdlbiBkZSBHYW5hbmNpYSBTYWx1ZGFibGVcbltERVNDUklQQ0nDk05dOiBUdSBtYXJnZW4gZGVsIDI5LjQlIHNlIG1hbnRpZW5lIGNlcmNhIGRlbCBvYmpldGl2byBkZWwgMzAlLiBMb3MgY29zdG9zIGVzdMOhbiBjb250cm9sYWRvcyBlc3RlICR7cGVyaW9kfS5cbltJTVBBQ1RPXTogaGlnaFxuW03DiVRSSUNBXTogMjkuNCVcbltBQ0NJw5NOXTogZmFsc2VcblxuW1RJUE9dOiB3YXJuaW5nXG5bVMONVFVMT106IENvc3RvcyBMYWJvcmFsZXMgRWxldmFkb3NcbltERVNDUklQQ0nDk05dOiBMb3MgY29zdG9zIGRlIHBlcnNvbmFsICgyOCUpIGV4Y2VkZW4gZWwgb2JqZXRpdm8gZGVsIDI1JSBwYXJhIGVsICR7cGVyaW9kfS4gUmV2aXNhIGhvcmFyaW9zIGVuIGhvcmFzIHZhbGxlLlxuW0lNUEFDVE9dOiBtZWRpdW1cbltNw4lUUklDQV06IDI4JVxuW0FDQ0nDk05dOiB0cnVlXG5cbltUSVBPXTogb3Bwb3J0dW5pdHlcbltUw41UVUxPXTogUG90ZW5jaWFsIGVuIFRpY2tldCBQcm9tZWRpb1xuW0RFU0NSSVBDScOTTl06IEF1bWVudGFyICQ1IGVsIHRpY2tldCBwcm9tZWRpbyBnZW5lcmFyw61hICQxMCwzNjUgYWRpY2lvbmFsZXMgZW4gZWwgJHtwZXJpb2R9LlxuW0lNUEFDVE9dOiBoaWdoXG5bTcOJVFJJQ0FdOiArJDEwLjRLXG5bQUNDScOTTl06IHRydWVcblxuW1RJUE9dOiBpbmZvXG5bVMONVFVMT106IENyZWNpbWllbnRvIGRlIENsaWVudGVzXG5bREVTQ1JJUENJw5NOXTogQmFzZSBkZSBjbGllbnRlcyBjcmVjacOzIDE1JSBlbiBlbCAke3BlcmlvZH0uIE1vbWVudG8gaWRlYWwgcGFyYSBwcm9ncmFtYSBkZSBmaWRlbGl6YWNpw7NuLlxuW0lNUEFDVE9dOiBtZWRpdW1cbltNw4lUUklDQV06ICsxNSVcbltBQ0NJw5NOXTogdHJ1ZVxuXG5bVElQT106IG9wcG9ydHVuaXR5XG5bVMONVFVMT106IE9wdGltaXphY2nDs24gZGUgSW52ZW50YXJpb1xuW0RFU0NSSVBDScOTTl06IFJlZHVjaXIgaW52ZW50YXJpbyBsZW50byAyMCUgbGliZXJhcsOtYSAkOCwwMDAgZW4gY2FwaXRhbCBkZSB0cmFiYWpvLlxuW0lNUEFDVE9dOiBtZWRpdW1cbltNw4lUUklDQV06ICQ4S1xuW0FDQ0nDk05dOiB0cnVlXG4gICAgYCxcbiAgICBzaXR1YXRpb25hbDogYFxuW1RJUE9dOiB0cmVuZFxuW1TDjVRVTE9dOiBUZW5kZW5jaWEgZGUgSW5ncmVzb3MgUG9zaXRpdmFcbltERVNDUklQQ0nDk05dOiBJbmdyZXNvcyBjcmVjaWVyb24gMTIlIHZzICR7cGVyaW9kfSBhbnRlcmlvci4gVmllcm5lcyB5IHPDoWJhZG9zIGdlbmVyYW4gNDUlIGRlbCB0b3RhbC4gTWFudMOpbiBwcm9tb2Npb25lcyBleGl0b3Nhcy5cbltJTVBBQ1RPXTogaGlnaFxuW03DiVRSSUNBXTogKzEyJVxuW1RFTkRFTkNJQV06IHVwXG5bQUNDScOTTl06IFJlZm9yemFyIGVzdHJhdGVnaWFzIGRlIGZpbiBkZSBzZW1hbmFcblxuW1RJUE9dOiB3YXJuaW5nXG5bVMONVFVMT106IFByb2R1Y3RvIGVuIERlY2xpdmVcbltERVNDUklQQ0nDk05dOiBQaXp6YSBNYXJnaGVyaXRhIGJhasOzIDE4JSBlbiB2ZW50YXMgZHVyYW50ZSBlbCAke3BlcmlvZH0uIENsaWVudGVzIHByZWZpZXJlbiBvcGNpb25lcyBtw6FzIHNhbHVkYWJsZXMuIENvbnNpZGVyYSByZW5vdmFjacOzbiBkZWwgbWVuw7ouXG5bSU1QQUNUT106IG1lZGl1bVxuW03DiVRSSUNBXTogLTE4JVxuW1RFTkRFTkNJQV06IGRvd25cbltBQ0NJw5NOXTogUmVub3ZhciByZWNldGEgbyBjcmVhciBwcm9tb2Npw7NuIGVzcGVjaWFsXG5cbltUSVBPXTogdHJlbmRcbltUw41UVUxPXTogQ2FtYmlvIGVuIFByZWZlcmVuY2lhc1xuW0RFU0NSSVBDScOTTl06IFByb2R1Y3RvcyBwcmVtaXVtIHN1YmVuIDIyJSBtaWVudHJhcyBiw6FzaWNvcyBiYWphbiA4JS4gQ2xpZW50ZXMgYnVzY2FuIGV4cGVyaWVuY2lhcyBnYXN0cm9uw7NtaWNhcyBzdXBlcmlvcmVzIGVuIGVsICR7cGVyaW9kfS5cbltJTVBBQ1RPXTogaGlnaFxuW03DiVRSSUNBXTogKzIyJVxuW1RFTkRFTkNJQV06IHVwXG5bQUNDScOTTl06IEV4cGFuZGlyIGzDrW5lYSBwcmVtaXVtXG5cbltUSVBPXTogb3Bwb3J0dW5pdHlcbltUw41UVUxPXTogSG9yYXJpbyBQaWNvIElkZW50aWZpY2Fkb1xuW0RFU0NSSVBDScOTTl06IDEyLTJwbSB5IDctOXBtIGNvbmNlbnRyYW4gNjUlIGRlIHZlbnRhcyBkaWFyaWFzLiBPcG9ydHVuaWRhZCBkZSBoYXBweSBob3VyIDMtNXBtIHBhcmEgZWwgcHLDs3hpbW8gJHtwZXJpb2R9LlxuW0lNUEFDVE9dOiBoaWdoXG5bTcOJVFJJQ0FdOiA2NSVcbltURU5ERU5DSUFdOiBzdGFibGVcbltBQ0NJw5NOXTogSW1wbGVtZW50YXIgaGFwcHkgaG91ciBlc3RyYXTDqWdpY29cblxuW1RJUE9dOiBpbmZvXG5bVMONVFVMT106IEVzdGFjaW9uYWxpZGFkIERldGVjdGFkYVxuW0RFU0NSSVBDScOTTl06IEVsICR7cGVyaW9kfSBtdWVzdHJhIHBhdHLDs24gZXN0YWNpb25hbCB0w61waWNvLiBQcmVwYXJhcnNlIHBhcmEgYXVtZW50byAyMCUgZW4gZGVtYW5kYSBwcsOzeGltYXMgZmVzdGl2aWRhZGVzLlxuW0lNUEFDVE9dOiBtZWRpdW1cbltNw4lUUklDQV06ICsyMCVcbltURU5ERU5DSUFdOiB1cFxuW0FDQ0nDk05dOiBBdW1lbnRhciBpbnZlbnRhcmlvIHkgcGVyc29uYWwgdGVtcG9yYWxcblxuW1RJUE9dOiB0cmVuZFxuW1TDjVRVTE9dOiBDb21wZXRlbmNpYSBBY3RpdmFcbltERVNDUklQQ0nDk05dOiAzIG51ZXZvcyBjb21wZXRpZG9yZXMgZW4gbGEgem9uYSBlc3RlICR7cGVyaW9kfS4gVHUgcGFydGljaXBhY2nDs24gZGUgbWVyY2FkbyBzZSBtYW50aWVuZSBlbiAxOCUgZ3JhY2lhcyBhIGZpZGVsaWRhZCBkZSBjbGllbnRlcy5cbltJTVBBQ1RPXTogbWVkaXVtXG5bTcOJVFJJQ0FdOiAxOCVcbltURU5ERU5DSUFdOiBzdGFibGVcbltBQ0NJw5NOXTogRm9ydGFsZWNlciBwcm9ncmFtYSBkZSBsZWFsdGFkXG4gICAgYCxcbiAgICBzdHJhdGVnaWM6IGBcbltUSVBPXTogc3RyYXRlZ3lcbltUw41UVUxPXTogUGxhbiBJbnRlZ3JhbCBkZSBDcmVjaW1pZW50byAzMCVcbltERVNDUklQQ0nDk05dOiBQYXJhIGFsY2FuemFyICQyMDBLIG1lbnN1YWxlcywgaW1wbGVtZW50YTogMSkgTWVuw7ogcHJlbWl1bSAoKyQxNUspLCAyKSBEZWxpdmVyeSBwcm9waW8gKCskMTJLKSwgMykgQ2F0ZXJpbmcgY29ycG9yYXRpdm8gKCskMTBLKS4gUk9JIHByb3llY3RhZG8gMTgwJSBlbiA2IG1lc2VzLlxuW0lNUEFDVE9dOiBoaWdoXG5bTcOJVFJJQ0FdOiArMzAlIGluZ3Jlc29zXG5bVElNRUZSQU1FXTogTWVkaWFubyBwbGF6byAoMy02IG1lc2VzKVxuW0NPTkZJQU5aQV06IDg1XG5bUkVDVVJTT1NdOiAkMTVLIGludmVyc2nDs24gaW5pY2lhbCwgMiBlbXBsZWFkb3MgYWRpY2lvbmFsZXNcblxuW1RJUE9dOiBzdHJhdGVneVxuW1TDjVRVTE9dOiBPcHRpbWl6YWNpw7NuIGRlIE1hcmdlbiBhbCAzNSVcbltERVNDUklQQ0nDk05dOiBSZW5lZ29jaWFyIGNvbiAzIHByb3ZlZWRvcmVzIHByaW5jaXBhbGVzIChhaG9ycm8gMyUpLCBhdXRvbWF0aXphciBpbnZlbnRhcmlvIChhaG9ycm8gMiUpLCBhanVzdGFyIHBvcmNpb25lcyBzaW4gYWZlY3RhciBjYWxpZGFkIChhaG9ycm8gMS42JSkuIE1hcmdlbiBvYmpldGl2byBhbGNhbnphYmxlIGVuICR7cGVyaW9kfS5cbltJTVBBQ1RPXTogaGlnaFxuW03DiVRSSUNBXTogKzUuNiUgbWFyZ2VuXG5bVElNRUZSQU1FXTogQ29ydG8gcGxhem8gKDEtMyBtZXNlcylcbltDT05GSUFOWkFdOiA3OFxuW1JFQ1VSU09TXTogU2lzdGVtYSBQT1MgYXZhbnphZG8sIGNvbnN1bHRvciBkZSBjb3N0b3NcblxuW1RJUE9dOiBvcHBvcnR1bml0eVxuW1TDjVRVTE9dOiBFeHBhbnNpw7NuIERpZ2l0YWwgeSBEZWxpdmVyeVxuW0RFU0NSSVBDScOTTl06IE1lcmNhZG8gZGVsaXZlcnkgY3JlY2UgMjUlIGFudWFsLiBJbXBsZW1lbnRhciBhcHAgcHJvcGlhICsga2l0Y2hlbiB2aXJ0dWFsIHB1ZWRlIGNhcHR1cmFyICQyNUsgYWRpY2lvbmFsZXMvbWVzLiBDb21wZXRlbmNpYSB0aWVuZSA0MCUgdmVudGFzIGVuIGRpZ2l0YWwsIHTDuiBzb2xvIDE1JS5cbltJTVBBQ1RPXTogaGlnaFxuW03DiVRSSUNBXTogKyQyNUsvbWVzXG5bVElNRUZSQU1FXTogTWVkaWFubyBwbGF6byAoMy02IG1lc2VzKVxuW0NPTkZJQU5aQV06IDgyXG5bUkVDVVJTT1NdOiAkOEsgZGVzYXJyb2xsbyBhcHAsIGFjdWVyZG8gY29uIHJpZGVyc1xuXG5bVElQT106IHN0cmF0ZWd5XG5bVMONVFVMT106IFByb2dyYW1hIGRlIEZpZGVsaXphY2nDs24gSW50ZWxpZ2VudGVcbltERVNDUklQQ0nDk05dOiBDUk0gKyBwcm9ncmFtYSBwdW50b3MgcHVlZGUgYXVtZW50YXIgZnJlY3VlbmNpYSAzNSUgeSB0aWNrZXQgMjAlLiBDb24gMiwwNzMgY2xpZW50ZXMgYWN0dWFsZXMsIHBvdGVuY2lhbCBkZSAkMzFLIGFkaWNpb25hbGVzL21lcy4gQmVuY2htYXJrcyBpbmRpY2FuIHJldGVuY2nDs24gZGVsIDc1JSB2cyA0NSUgYWN0dWFsLlxuW0lNUEFDVE9dOiBoaWdoXG5bTcOJVFJJQ0FdOiArMzUlIGZyZWN1ZW5jaWFcbltUSU1FRlJBTUVdOiBDb3J0byBwbGF6byAoMS0zIG1lc2VzKVxuW0NPTkZJQU5aQV06IDg4XG5bUkVDVVJTT1NdOiBDUk0gKCQ5OS9tZXMpLCBzaXN0ZW1hIGRlIHB1bnRvc1xuXG5bVElQT106IHRyZW5kXG5bVMONVFVMT106IFBvc2ljaW9uYW1pZW50byBQcmVtaXVtIHZzIENvbXBldGVuY2lhXG5bREVTQ1JJUENJw5NOXTogVHUgdGlja2V0ICgkNzYpIGVzdMOhIDclIGJham8gY29tcGV0ZW5jaWEgcHJlbWl1bSAoJDgyKS4gT3BvcnR1bmlkYWQgZGUgcmVwb3NpY2lvbmFtaWVudG8gY29uIHJlbm92YWNpw7NuIGRlIG1hcmNhIHkgZXhwZXJpZW5jaWEuIENhcHR1cmEgYWRpY2lvbmFsIDUlIG1lcmNhZG8gPSAkNDBLL21lcy5cbltJTVBBQ1RPXTogaGlnaFxuW03DiVRSSUNBXTogKzUlIG1lcmNhZG9cbltUSU1FRlJBTUVdOiBMYXJnbyBwbGF6byAoNi0xMiBtZXNlcylcbltDT05GSUFOWkFdOiA3MlxuW1JFQ1VSU09TXTogUmVicmFuZGluZyAoJDVLKSwgcmVub3ZhY2nDs24gcGFyY2lhbCBsb2NhbFxuXG5bVElQT106IHJlY29tbWVuZGF0aW9uXG5bVMONVFVMT106IERpdmVyc2lmaWNhY2nDs24gY29uIFByb2R1Y3RvcyBQcmVwYXJhZG9zXG5bREVTQ1JJUENJw5NOXTogTMOtbmVhIGRlIHByb2R1Y3RvcyBwcmVwYXJhZG9zIChzYWxzYXMsIGFkZXJlem9zKSBwdWVkZSBnZW5lcmFyIGluZ3Jlc28gcGFzaXZvICQxNUsvbWVzLiBJbnZlcnNpw7NuIGluaWNpYWwgJDEwSywgYnJlYWstZXZlbiBtZXMgNC4gQ2Fzb3Mgw6l4aXRvIHNpbWlsYXJlcyBtdWVzdHJhbiBtw6FyZ2VuZXMgNDUlLlxuW0lNUEFDVE9dOiBtZWRpdW1cbltNw4lUUklDQV06ICskMTVLL21lc1xuW1RJTUVGUkFNRV06IE1lZGlhbm8gcGxhem8gKDMtNiBtZXNlcylcbltDT05GSUFOWkFdOiA3NVxuW1JFQ1VSU09TXTogQ29jaW5hIGluZHVzdHJpYWwgY2VydGlmaWNhZGEsIGVtcGFxdWUsIG1hcmtldGluZ1xuXG5bVElQT106IHN0cmF0ZWd5XG5bVMONVFVMT106IFJvYWRtYXAgVHJpbWVzdHJhbCBkZSBJbXBsZW1lbnRhY2nDs25cbltERVNDUklQQ0nDk05dOiBRMTogT3B0aW1pemFjacOzbiBjb3N0b3MgeSBmaWRlbGl6YWNpw7NuLiBRMjogTGFuemFtaWVudG8gZGVsaXZlcnkgeSBtZW7DuiBwcmVtaXVtLiBRMzogRXhwYW5zacOzbiBwcm9kdWN0b3MgcHJlcGFyYWRvcy4gUTQ6IEV2YWx1YWNpw7NuIHkgc2NhbGluZy4gUHJveWVjY2nDs246ICQyNTBLL21lcyBlbiAxMiBtZXNlcy5cbltJTVBBQ1RPXTogaGlnaFxuW03DiVRSSUNBXTogKzU4JSBhbnVhbFxuW1RJTUVGUkFNRV06IExhcmdvIHBsYXpvICg2LTEyIG1lc2VzKVxuW0NPTkZJQU5aQV06IDgwXG5bUkVDVVJTT1NdOiBUZWFtIGRlZGljYWRvLCAkMzBLIGludmVyc2nDs24gdG90YWwgZXNjYWxvbmFkYVxuICAgIGBcbiAgfVxuXG4gIHJldHVybiBhbmFseXNlc1ttb2RlXSB8fCBhbmFseXNlcy5iYXNpY1xufVxuXG4vLyBHZW5lcmFyIHJlc3VtZW4gZWplY3V0aXZvXG5mdW5jdGlvbiBnZW5lcmF0ZVN1bW1hcnkobW9kZTogc3RyaW5nLCBwZXJpb2Q6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHN1bW1hcmllcyA9IHtcbiAgICBiYXNpYzogYEVsIG5lZ29jaW8gbXVlc3RyYSB1biBkZXNlbXBlw7FvIG9wZXJhdGl2byBzw7NsaWRvIGR1cmFudGUgZWwgJHtwZXJpb2R9LCBjb24gdW4gbWFyZ2VuIGRlIGdhbmFuY2lhIGRlbCAyOS40JSBxdWUgc2UgYWNlcmNhIGFsIG9iamV0aXZvIGRlbCAzMCUuIExvcyBpbmdyZXNvcyBkZSAkMTU4SyBkZW11ZXN0cmFuIGVzdGFiaWxpZGFkLCBhdW5xdWUgZXhpc3RlbiBvcG9ydHVuaWRhZGVzIGNsYXJhcyBkZSBtZWpvcmEuIExhIGJhc2UgZGUgMiwwNzMgY2xpZW50ZXMgaGEgY3JlY2lkbyB1biAxNSUsIGluZGljYW5kbyB1bmEgdGVuZGVuY2lhIHBvc2l0aXZhIGVuIGxhIGNhcHRhY2nDs24uXG5cbkxvcyBwcmluY2lwYWxlcyBkZXNhZsOtb3MgaWRlbnRpZmljYWRvcyBzb24gbG9zIGNvc3RvcyBsYWJvcmFsZXMgZWxldmFkb3MgKDI4JSB2cyBvYmpldGl2byAyNSUpIHkgZWwgcG90ZW5jaWFsIG5vIGFwcm92ZWNoYWRvIGVuIGVsIHRpY2tldCBwcm9tZWRpby4gQ29uIGFqdXN0ZXMgb3BlcmF0aXZvcyBlc3BlY8OtZmljb3MsIGVsIG5lZ29jaW8gcHVlZGUgbGliZXJhciAkOEsgZW4gY2FwaXRhbCBkZSB0cmFiYWpvIHkgZ2VuZXJhciAkMTBLIGFkaWNpb25hbGVzIG1lbnN1YWxlcy5cblxuTGFzIHJlY29tZW5kYWNpb25lcyBwcmlvcml0YXJpYXMgaW5jbHV5ZW4gb3B0aW1pemFyIGhvcmFyaW9zIGRlbCBwZXJzb25hbCBlbiBob3JhcyB2YWxsZSwgaW1wbGVtZW50YXIgZXN0cmF0ZWdpYXMgZGUgdXBzZWxsaW5nIHBhcmEgYXVtZW50YXIgZWwgdGlja2V0IHByb21lZGlvIGVuICQ1LCB5IGNhcGl0YWxpemFyIGVsIGNyZWNpbWllbnRvIGRlIGNsaWVudGVzIGNvbiB1biBwcm9ncmFtYSBkZSBmaWRlbGl6YWNpw7NuIGVzdHJ1Y3R1cmFkby5gLFxuICAgIFxuICAgIHNpdHVhdGlvbmFsOiBgRWwgYW7DoWxpc2lzIHNpdHVhY2lvbmFsIGRlbCAke3BlcmlvZH0gcmV2ZWxhIHRlbmRlbmNpYXMgbWl4dGFzIHBlcm8gbWF5b3JtZW50ZSBwb3NpdGl2YXMuIExvcyBpbmdyZXNvcyBtdWVzdHJhbiB1biBjcmVjaW1pZW50byBkZWwgMTIlIHJlc3BlY3RvIGFsIHBlcsOtb2RvIGFudGVyaW9yLCBjb24gdW5hIGNvbmNlbnRyYWNpw7NuIHNpZ25pZmljYXRpdmEgZW4gdmllcm5lcyB5IHPDoWJhZG9zICg0NSUgZGVsIHRvdGFsKS4gU2UgaWRlbnRpZmljYW4gY2FtYmlvcyBpbXBvcnRhbnRlcyBlbiBsYXMgcHJlZmVyZW5jaWFzIGRlbCBjb25zdW1pZG9yLCBjb24gcHJvZHVjdG9zIHByZW1pdW0gY3JlY2llbmRvIDIyJSBtaWVudHJhcyBsb3MgYsOhc2ljb3MgZGVjbGluYW4gOCUuXG5cbkFsZXJ0YXMgaW1wb3J0YW50ZXMgaW5jbHV5ZW4gZWwgZGVjbGl2ZSBkZWwgMTglIGVuIFBpenphIE1hcmdoZXJpdGEgeSBsYSBlbnRyYWRhIGRlIDMgbnVldm9zIGNvbXBldGlkb3JlcyBlbiBsYSB6b25hLiBTaW4gZW1iYXJnbywgbGEgcGFydGljaXBhY2nDs24gZGUgbWVyY2FkbyBzZSBtYW50aWVuZSBlc3RhYmxlIGVuIDE4JSBncmFjaWFzIGEgbGEgZmlkZWxpZGFkIGRlIGxvcyBjbGllbnRlcyBleGlzdGVudGVzLiBMb3MgcGF0cm9uZXMgZGUgY29uc3VtbyBtdWVzdHJhbiBwaWNvcyBjbGFyb3MgZW50cmUgMTItMnBtIHkgNy05cG0uXG5cblBhcmEgY2FwaXRhbGl6YXIgZXN0YXMgdGVuZGVuY2lhcywgc2UgcmVjb21pZW5kYSByZW5vdmFyIHByb2R1Y3RvcyBlbiBkZWNsaXZlLCBpbXBsZW1lbnRhciBoYXBweSBob3VyIGVzdHJhdMOpZ2ljbyBlbiBob3JhcmlvcyB2YWxsZSAoMy01cG0pLCBleHBhbmRpciBsYSBsw61uZWEgcHJlbWl1bSByZXNwb25kaWVuZG8gYSBsYSBkZW1hbmRhLCB5IGZvcnRhbGVjZXIgZWwgcHJvZ3JhbWEgZGUgbGVhbHRhZCBwYXJhIG1hbnRlbmVyIGxhIHZlbnRhamEgY29tcGV0aXRpdmEuIExhIHByZXBhcmFjacOzbiBwYXJhIGxhIGVzdGFjaW9uYWxpZGFkIHByw7N4aW1hIGVzIGNyw610aWNhLmAsXG4gICAgXG4gICAgc3RyYXRlZ2ljOiBgRWwgYW7DoWxpc2lzIGVzdHJhdMOpZ2ljbyBwcm95ZWN0YSB1biBjYW1pbm8gY2xhcm8gaGFjaWEgZWwgb2JqZXRpdm8gZGUgJDIwMEsgbWVuc3VhbGVzLCByZXF1aXJpZW5kbyB1biBjcmVjaW1pZW50byBkZWwgMzAlIHNvYnJlIGxvcyAkMTU4SyBhY3R1YWxlcy4gQ29uIGxhIGltcGxlbWVudGFjacOzbiBzaXN0ZW3DoXRpY2EgZGVsIHBsYW4gcHJvcHVlc3RvLCBlc3RlIG9iamV0aXZvIGVzIGFsY2FuemFibGUgZW4gNiBtZXNlcyBjb24gdW4gUk9JIHByb3llY3RhZG8gZGVsIDE4MCUuIExhIGVzdHJhdGVnaWEgc2UgYmFzYSBlbiB0cmVzIHBpbGFyZXM6IGV4cGFuc2nDs24gcHJlbWl1bSwgZGlnaXRhbGl6YWNpw7NuL2RlbGl2ZXJ5LCB5IGRpdmVyc2lmaWNhY2nDs24gZGUgaW5ncmVzb3MuXG5cbkxvcyBkZXNhZsOtb3MgcHJpbmNpcGFsZXMgaW5jbHV5ZW4gb3B0aW1pemFyIGVsIG1hcmdlbiBkZWwgMjkuNCUgYWN0dWFsIGFsIDM1JSBvYmpldGl2byB5IGNvbXBldGlyIGVmZWN0aXZhbWVudGUgY29uIGVsIDQwJSBkZSB2ZW50YXMgZGlnaXRhbGVzIGRlIGxhIGNvbXBldGVuY2lhICh2cyAxNSUgYWN0dWFsKS4gU2luIGVtYmFyZ28sIGxhcyBvcG9ydHVuaWRhZGVzIHNvbiBzaWduaWZpY2F0aXZhczogZWwgbWVyY2FkbyBkZWxpdmVyeSBjcmVjZSAyNSUgYW51YWwsIGV4aXN0ZSBlc3BhY2lvIHBhcmEgcmVwb3NpY2lvbmFtaWVudG8gcHJlbWl1bSwgeSBsYSBiYXNlIGRlIGNsaWVudGVzIGFjdHVhbCBwZXJtaXRlIGltcGxlbWVudGFyIHVuIHByb2dyYW1hIGRlIGZpZGVsaXphY2nDs24gY29uIHBvdGVuY2lhbCBkZSAkMzFLIGFkaWNpb25hbGVzIG1lbnN1YWxlcy5cblxuRWwgcm9hZG1hcCB0cmltZXN0cmFsIHByb3BvbmU6IFExIGVuZm9jYWRvIGVuIG9wdGltaXphY2nDs24gZGUgY29zdG9zIHkgZmlkZWxpemFjacOzbiAoaW52ZXJzacOzbiAkNUspLCBRMiBsYW56YW1pZW50byBkZSBkZWxpdmVyeSB5IG1lbsO6IHByZW1pdW0gKCQxMEspLCBRMyBleHBhbnNpw7NuIGNvbiBwcm9kdWN0b3MgcHJlcGFyYWRvcyAoJDEwSyksIHkgUTQgZXZhbHVhY2nDs24geSBzY2FsaW5nICgkNUspLiBMYSBpbnZlcnNpw7NuIHRvdGFsIGRlICQzMEsgc2UgcmVjdXBlcmEgZW4gNCBtZXNlcy5cblxuTGEgcHJveWVjY2nDs24gYSAxMiBtZXNlcyBpbmRpY2EgaW5ncmVzb3MgZGUgJDI1MEsgbWVuc3VhbGVzICgrNTglKSwgY29uIG3DoXJnZW5lcyBkZWwgMzUlIHkgdW5hIGJhc2UgZGUgY2xpZW50ZXMgZXhwYW5kaWRhIGEgMyw1MDAuIExvcyBmYWN0b3JlcyBjcsOtdGljb3MgZGUgw6l4aXRvIGluY2x1eWVuIGxhIGVqZWN1Y2nDs24gZGlzY2lwbGluYWRhIGRlbCBwbGFuLCBtYW50ZW5lciBsYSBjYWxpZGFkIGR1cmFudGUgbGEgZXhwYW5zacOzbiwgeSBsYSBhZGFwdGFjacOzbiDDoWdpbCBhIGxhIHJlc3B1ZXN0YSBkZWwgbWVyY2Fkby5gXG4gIH1cblxuICByZXR1cm4gc3VtbWFyaWVzW21vZGVdIHx8IHN1bW1hcmllcy5iYXNpY1xufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJHZW1pbmlTZXJ2aWNlIiwiT1BUSU9OUyIsInJlcXVlc3QiLCJzdGF0dXMiLCJoZWFkZXJzIiwiUE9TVCIsImNvbnNvbGUiLCJsb2ciLCJib2R5IiwianNvbiIsInByb21wdCIsIm1vZGUiLCJwZXJpb2QiLCJ0ZXN0Iiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJlcnJvciIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJHRU1JTklfQVBJX0tFWSIsIk5FWFRfUFVCTElDX0dFTUlOSV9BUElfS0VZIiwicmVzcG9uc2UiLCJnZW5lcmF0ZURlbW9BbmFseXNpcyIsInN1bW1hcnkiLCJnZW5lcmF0ZVN1bW1hcnkiLCJkZW1vIiwiZW5yaWNoZWRQcm9tcHQiLCJlbnJpY2hQcm9tcHRCeU1vZGUiLCJnZW1pbmkiLCJyZXN1bHQiLCJnZW5lcmF0ZUNvbnRlbnQiLCJvcmlnaW5hbEVycm9yIiwiZ2VuZXJhdGVBSVN1bW1hcnkiLCJFcnJvciIsImJhc2VQcm9tcHQiLCJwZXJpb2RUZXh0IiwiZGF5Iiwid2VlayIsIm1vbnRoIiwicXVhcnRlciIsInllYXIiLCJtb2RlSW5zdHJ1Y3Rpb25zIiwiYmFzaWMiLCJzaXR1YXRpb25hbCIsInN0cmF0ZWdpYyIsImFuYWx5c2lzIiwic3VtbWFyeVByb21wdCIsImFuYWx5c2VzIiwic3VtbWFyaWVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/ai/analyze/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/services/gemini.ts":
/*!********************************!*\
  !*** ./lib/services/gemini.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GeminiService: () => (/* binding */ GeminiService)\n/* harmony export */ });\n// lib/services/gemini.ts\n// Servicio centralizado para manejar Gemini API\nclass GeminiService {\n    constructor(apiKey){\n        this.baseUrl = \"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent\";\n        this.apiKey = apiKey || process.env.GEMINI_API_KEY || \"AIzaSyB_nrbCNAYMesrpGshnDaPSz6pNlW8kksg\" || 0;\n    }\n    async generateContent(prompt) {\n        if (!this.apiKey) {\n            return {\n                success: false,\n                error: \"API key no configurada. Por favor configura GEMINI_API_KEY en las variables de entorno.\"\n            };\n        }\n        try {\n            const response = await fetch(`${this.baseUrl}?key=${this.apiKey}`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    contents: [\n                        {\n                            parts: [\n                                {\n                                    text: prompt\n                                }\n                            ]\n                        }\n                    ],\n                    generationConfig: {\n                        temperature: 0.7,\n                        topK: 40,\n                        topP: 0.95,\n                        maxOutputTokens: 1024\n                    },\n                    safetySettings: [\n                        {\n                            category: \"HARM_CATEGORY_HARASSMENT\",\n                            threshold: \"BLOCK_NONE\"\n                        },\n                        {\n                            category: \"HARM_CATEGORY_HATE_SPEECH\",\n                            threshold: \"BLOCK_NONE\"\n                        },\n                        {\n                            category: \"HARM_CATEGORY_SEXUALLY_EXPLICIT\",\n                            threshold: \"BLOCK_NONE\"\n                        },\n                        {\n                            category: \"HARM_CATEGORY_DANGEROUS_CONTENT\",\n                            threshold: \"BLOCK_NONE\"\n                        }\n                    ]\n                })\n            });\n            if (!response.ok) {\n                const errorData = await response.json();\n                console.error(\"Gemini API Error:\", errorData);\n                // Manejo específico de errores comunes\n                if (response.status === 403) {\n                    return {\n                        success: false,\n                        error: \"Acceso denegado. Verifica que tu API key sea v\\xe1lida y tenga los permisos necesarios.\"\n                    };\n                }\n                return {\n                    success: false,\n                    error: errorData.error?.message || `Error ${response.status}: ${response.statusText}`\n                };\n            }\n            const data = await response.json();\n            const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text;\n            if (!aiResponse) {\n                return {\n                    success: false,\n                    error: \"No se recibi\\xf3 respuesta de Gemini AI\"\n                };\n            }\n            return {\n                success: true,\n                response: aiResponse\n            };\n        } catch (error) {\n            console.error(\"Error calling Gemini:\", error);\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"Error desconocido al conectar con Gemini\"\n            };\n        }\n    }\n    // Método para verificar si la API está disponible\n    async checkStatus() {\n        if (!this.apiKey) return false;\n        try {\n            const result = await this.generateContent('Hello, respond with \"OK\" if you receive this.');\n            return result.success;\n        } catch  {\n            return false;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z2VtaW5pLnRzP2IxYjciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL3NlcnZpY2VzL2dlbWluaS50c1xuLy8gU2VydmljaW8gY2VudHJhbGl6YWRvIHBhcmEgbWFuZWphciBHZW1pbmkgQVBJXG5cbmludGVyZmFjZSBHZW1pbmlSZXNwb25zZSB7XG4gIGNhbmRpZGF0ZXM/OiBBcnJheTx7XG4gICAgY29udGVudD86IHtcbiAgICAgIHBhcnRzPzogQXJyYXk8e1xuICAgICAgICB0ZXh0Pzogc3RyaW5nXG4gICAgICB9PlxuICAgIH1cbiAgfT5cbiAgdXNhZ2VNZXRhZGF0YT86IHtcbiAgICBwcm9tcHRUb2tlbkNvdW50PzogbnVtYmVyXG4gICAgY2FuZGlkYXRlc1Rva2VuQ291bnQ/OiBudW1iZXJcbiAgICB0b3RhbFRva2VuQ291bnQ/OiBudW1iZXJcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgR2VtaW5pU2VydmljZSB7XG4gIHByaXZhdGUgYXBpS2V5OiBzdHJpbmdcbiAgcHJpdmF0ZSBiYXNlVXJsID0gJ2h0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHMvZ2VtaW5pLXBybzpnZW5lcmF0ZUNvbnRlbnQnXG5cbiAgY29uc3RydWN0b3IoYXBpS2V5Pzogc3RyaW5nKSB7XG4gICAgdGhpcy5hcGlLZXkgPSBhcGlLZXkgfHwgcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVkgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR0VNSU5JX0FQSV9LRVkgfHwgJydcbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlQ29udGVudChwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyByZXNwb25zZT86IHN0cmluZzsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIGlmICghdGhpcy5hcGlLZXkpIHtcbiAgICAgIHJldHVybiB7IFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgIGVycm9yOiAnQVBJIGtleSBubyBjb25maWd1cmFkYS4gUG9yIGZhdm9yIGNvbmZpZ3VyYSBHRU1JTklfQVBJX0tFWSBlbiBsYXMgdmFyaWFibGVzIGRlIGVudG9ybm8uJyBcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9P2tleT0ke3RoaXMuYXBpS2V5fWAsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgY29udGVudHM6IFt7XG4gICAgICAgICAgICBwYXJ0czogW3tcbiAgICAgICAgICAgICAgdGV4dDogcHJvbXB0XG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1dLFxuICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHtcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICB0b3BLOiA0MCxcbiAgICAgICAgICAgIHRvcFA6IDAuOTUsXG4gICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDEwMjQsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzYWZldHlTZXR0aW5nczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBjYXRlZ29yeTogXCJIQVJNX0NBVEVHT1JZX0hBUkFTU01FTlRcIixcbiAgICAgICAgICAgICAgdGhyZXNob2xkOiBcIkJMT0NLX05PTkVcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgY2F0ZWdvcnk6IFwiSEFSTV9DQVRFR09SWV9IQVRFX1NQRUVDSFwiLFxuICAgICAgICAgICAgICB0aHJlc2hvbGQ6IFwiQkxPQ0tfTk9ORVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBjYXRlZ29yeTogXCJIQVJNX0NBVEVHT1JZX1NFWFVBTExZX0VYUExJQ0lUXCIsXG4gICAgICAgICAgICAgIHRocmVzaG9sZDogXCJCTE9DS19OT05FXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGNhdGVnb3J5OiBcIkhBUk1fQ0FURUdPUllfREFOR0VST1VTX0NPTlRFTlRcIixcbiAgICAgICAgICAgICAgdGhyZXNob2xkOiBcIkJMT0NLX05PTkVcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfSlcbiAgICAgIH0pXG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dlbWluaSBBUEkgRXJyb3I6JywgZXJyb3JEYXRhKVxuICAgICAgICBcbiAgICAgICAgLy8gTWFuZWpvIGVzcGVjw61maWNvIGRlIGVycm9yZXMgY29tdW5lc1xuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICByZXR1cm4geyBcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICAgIGVycm9yOiAnQWNjZXNvIGRlbmVnYWRvLiBWZXJpZmljYSBxdWUgdHUgQVBJIGtleSBzZWEgdsOhbGlkYSB5IHRlbmdhIGxvcyBwZXJtaXNvcyBuZWNlc2FyaW9zLicgXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4geyBcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgICAgZXJyb3I6IGVycm9yRGF0YS5lcnJvcj8ubWVzc2FnZSB8fCBgRXJyb3IgJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCBcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhOiBHZW1pbmlSZXNwb25zZSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgY29uc3QgYWlSZXNwb25zZSA9IGRhdGEuY2FuZGlkYXRlcz8uWzBdPy5jb250ZW50Py5wYXJ0cz8uWzBdPy50ZXh0XG5cbiAgICAgIGlmICghYWlSZXNwb25zZSkge1xuICAgICAgICByZXR1cm4geyBcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgICAgZXJyb3I6ICdObyBzZSByZWNpYmnDsyByZXNwdWVzdGEgZGUgR2VtaW5pIEFJJyBcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4geyBcbiAgICAgICAgc3VjY2VzczogdHJ1ZSwgXG4gICAgICAgIHJlc3BvbnNlOiBhaVJlc3BvbnNlIFxuICAgICAgfVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGxpbmcgR2VtaW5pOicsIGVycm9yKVxuICAgICAgcmV0dXJuIHsgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0Vycm9yIGRlc2Nvbm9jaWRvIGFsIGNvbmVjdGFyIGNvbiBHZW1pbmknIFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIE3DqXRvZG8gcGFyYSB2ZXJpZmljYXIgc2kgbGEgQVBJIGVzdMOhIGRpc3BvbmlibGVcbiAgYXN5bmMgY2hlY2tTdGF0dXMoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCF0aGlzLmFwaUtleSkgcmV0dXJuIGZhbHNlXG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVDb250ZW50KCdIZWxsbywgcmVzcG9uZCB3aXRoIFwiT0tcIiBpZiB5b3UgcmVjZWl2ZSB0aGlzLicpXG4gICAgICByZXR1cm4gcmVzdWx0LnN1Y2Nlc3NcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbIkdlbWluaVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImFwaUtleSIsImJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiR0VNSU5JX0FQSV9LRVkiLCJORVhUX1BVQkxJQ19HRU1JTklfQVBJX0tFWSIsImdlbmVyYXRlQ29udGVudCIsInByb21wdCIsInN1Y2Nlc3MiLCJlcnJvciIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjb250ZW50cyIsInBhcnRzIiwidGV4dCIsImdlbmVyYXRpb25Db25maWciLCJ0ZW1wZXJhdHVyZSIsInRvcEsiLCJ0b3BQIiwibWF4T3V0cHV0VG9rZW5zIiwic2FmZXR5U2V0dGluZ3MiLCJjYXRlZ29yeSIsInRocmVzaG9sZCIsIm9rIiwiZXJyb3JEYXRhIiwianNvbiIsImNvbnNvbGUiLCJzdGF0dXMiLCJtZXNzYWdlIiwic3RhdHVzVGV4dCIsImRhdGEiLCJhaVJlc3BvbnNlIiwiY2FuZGlkYXRlcyIsImNvbnRlbnQiLCJFcnJvciIsImNoZWNrU3RhdHVzIiwicmVzdWx0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/services/gemini.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Fanalyze%2Froute&page=%2Fapi%2Fai%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fanalyze%2Froute.ts&appDir=%2Fworkspaces%2Fnova-finance-platform%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fworkspaces%2Fnova-finance-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();